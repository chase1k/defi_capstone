<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Echidna Coverage Report</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:ital,wght@0,100..700;1,100..700&family=Roboto:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
    <style>
:root {
    --primary: #6366f1;
    --primary-hover: #4f46e5;
    --primary-light: rgba(99,102,241,0.1);
    --success: #22c55e;
    --warning: #eab308;
    --danger: #ef4444;
    --gray-50: #f9fafb;
    --gray-100: #f3f4f6;
    --gray-200: #e5e7eb;
    --gray-400: #9ca3af;
    --gray-500: #6b7280;
    --gray-600: #4b5563;
    --gray-700: #374151;
    --gray-800: #1f2937;
    --surface: #fff;
    --text: var(--gray-800);
    --text-light: var(--gray-500);
    --radius: 0.375rem;
    --shadow-sm: 0 1px 2px rgba(0,0,0,0.05);
    --shadow: 0 1px 3px rgba(0,0,0,0.1);
    --success-rgb: 34,197,94;
    --warning-rgb: 234,179,8;
    --danger-rgb: 239,68,68;
}

/* Reset */
* {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
}

body {
    font-family: 'Roboto', -apple-system, sans-serif;
    font-size: 0.875rem;
    line-height: 1.5;
    color: var(--text);
    background: var(--gray-50);
    height: 100vh;
    display: flex;
    flex-direction: column;
    overflow: hidden;
}

a {
    color: var(--primary);
    text-decoration: none;
}

a:hover {
    color: var(--primary-hover);
    text-decoration: underline;
}

button {
    cursor: pointer;
    background: transparent;
    border: none;
    padding: 0;
    font: inherit;
    color: inherit;
    outline: none;
}

/* Layout */
.app-container {
    display: flex;
    flex-direction: column;
    height: 100vh;
    overflow: hidden;
}

header {
    background: var(--surface);
    border-bottom: 1px solid var(--gray-200);
    padding: 1rem 1.5rem;
    z-index: 10;
    box-shadow: var(--shadow-sm);
}

.header-content {
    display: flex;
    align-items: center;
    justify-content: space-between;
    max-width: 1400px;
    margin: 0;
    width: 100%;
}

.logo-text {
    font-size: 1.5rem;
    font-weight: 600;
    color: var(--gray-800);
}

/* Buttons */
.btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    height: 2.25rem;
    padding: 0 0.5rem;
    font-size: 0.875rem;
    font-weight: 500;
    border-radius: var(--radius);
    transition: all 0.2s;
    border: 1px solid transparent;
}

.btn-secondary {
    background: #B92B3D;
    border-color: #B92B3D;
    color: white;
}

.btn-secondary:hover {
    background: #9e2434;
    border-color: #9e2434;
}

.btn-sm {
    height: 2rem;
    padding: 0 0.5rem;
    font-size: 0.75rem;
}

.button-group {
    display: flex;
    gap: 0.75rem;
    width: 100%;
}

.button-group .btn {
    flex: 1;
}

/* Split panel layout */
.split-panel {
    display: flex;
    flex: 1;
    overflow: hidden;
    position: relative;
}

#file-split-panel {
    display: flex;
    flex-direction: row;
}

/* File explorer panel */
#file-explorer {
    flex: 0 0 260px;
    height: 100%;
    overflow: auto;
    background: var(--surface);
    border-right: 1px solid var(--gray-200);
    padding: 0;
    position: relative;
    min-width: 200px;
    max-width: 500px;
    display: flex;
    flex-direction: column;
    overflow-x: hidden; /* to not show horizontal scrollbar with resizer */
}

#file-explorer-resizer {
    position: absolute;
    top: 0;
    right: -5px;
    width: 10px;
    height: 100%;
    cursor: col-resize;
    z-index: 10;
    background: linear-gradient(to right, transparent, rgba(0,0,0,0.05), transparent);
}

#file-explorer-resizer:hover {
    background: linear-gradient(to right, transparent, rgba(0,0,0,0.1), transparent);
}

.file-explorer-header {
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 1rem;
    border-bottom: 1px solid var(--gray-200);
}

.file-search {
    padding: 0.5rem 1rem;
    border-bottom: 1px solid var(--gray-200);
    display: flex;
    align-items: center;
}

.file-search input {
    flex: 1;
    border: 1px solid var(--gray-300);
    border-radius: var(--radius);
    padding: 0.5rem;
    font-size: 0.875rem;
    outline: none;
}

.file-search input:focus {
    border-color: var(--primary);
    box-shadow: 0 0 0 1px var(--primary-light);
}

#file-search-clear {
    margin-left: 0.5rem;
    color: var(--gray-500);
    font-size: 1.25rem;
    line-height: 1;
    padding: 0.25rem;
    border-radius: var(--radius);
}

#file-search-clear:hover {
    background: var(--gray-100);
}

.search-highlight {
    background: var(--primary-light);
    color: var(--primary);
    font-weight: 500;
}

.search-no-results {
    padding: 1rem;
    font-style: italic;
    color: var(--gray-500);
    text-align: center;
}

.file-explorer-content {
    overflow: auto;
    flex: 1;
    padding: 1rem;
}

.file-explorer-title {
    font-size: 0.875rem;
    font-weight: 600;
    margin: 0;
    color: var(--gray-600);
    text-transform: uppercase;
    letter-spacing: 0.05em;
}

/* Main view panel */
#main-view-panel {
    flex: 1;
    height: 100%;
    overflow: auto;
    padding: 1.5rem;
    background: var(--gray-50);
}

/* Stats cards */
.stats-container {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1rem;
    margin-bottom: 1.5rem;
}

.stat-card {
    background: var(--surface);
    border-radius: var(--radius);
    padding: 1.25rem;
    box-shadow: var(--shadow);
    display: flex;
    flex-direction: column;
}

.stat-title {
    font-size: 0.875rem;
    color: var(--text-light);
    margin-bottom: 0.5rem;
}

.stat-value {
    font-size: 1.5rem;
    font-weight: 600;
    margin-bottom: 0.5rem;
}

.stat-badge {
    display: inline-flex;
    align-items: center;
    padding: 0.25rem 0.5rem;
    border-radius: 9999px;
    font-size: 0.75rem;
    font-weight: 500;
    background: var(--primary-light);
    color: var(--primary);
}

/* Progress bar */
.progress-container {
    width: 100%;
    height: 0.5rem;
    background: var(--gray-200);
    border-radius: 9999px;
    overflow: hidden;
    margin-top: 0.5rem;
}

.progress-bar {
    height: 100%;
    border-radius: 9999px;
    transition: width 0.3s;
}

/* File tree */
.file-tree {
    list-style: none;
    padding-left: 0;
    margin: 0;
    font-size: 0.875rem;
}

.file-tree li {
    margin: 0.25rem 0;
}

.file-tree ul {
    list-style: none;
    padding-left: 1.25rem;
    margin: 0.25rem 0;
}

.file-item {
    display: flex;
    align-items: center;
    cursor: pointer;
    padding: 0.375rem 0.5rem;
    border-radius: var(--radius);
    transition: background-color 0.2s;
}

.file-item:hover {
    background: var(--gray-100);
}

.file-item.active {
    background: var(--primary-light);
    color: var(--primary);
}

.file-toggle {
    width: 1.25rem;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.75rem;
    color: var(--gray-500);
}

.file-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    margin-right: 0.5rem;
    color: var(--gray-500);
}

.file-name {
    flex: 1;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.file-coverage {
    width: 0.75rem;
    height: 0.75rem;
    border-radius: 50%;
    margin-left: 0.5rem;
}

/* File tree icons */
.directory > .file-item > .file-icon:before { content: "ðŸ“"; }
.directory.expanded > .file-item > .file-icon:before { content: "ðŸ“‚"; }
.file > .file-item > .file-icon:before { content: "ðŸ“„"; }
.directory > .file-item > .file-toggle:before { content: "â–¶"; }
.directory.expanded > .file-item > .file-toggle:before { content: "â–¼"; }
.file > .file-item > .file-toggle { visibility: hidden; }
.directory > ul { display: none; }
.directory.expanded > ul { display: block; }

/* Source files */
.source-file {
    margin-bottom: 1.5rem;
    border-radius: var(--radius);
    overflow: hidden;
    box-shadow: var(--shadow);
    background: var(--surface);
}

.source-file-header {
    padding: 0.75rem 1rem;
    background: #12181E;
    color: white;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: space-between;
    transition: background-color 0.2s;
}

.source-file-header:hover {
    background: #1e2832;
}

.source-file-header .file-info {
    display: flex;
    align-items: center;
    gap: 1rem;
}

.source-file-header .file-name {
    font-weight: 500;
}

.source-file-header .coverage-badge {
    display: inline-flex;
    align-items: center;
    padding: 0.25rem 0.5rem;
    border-radius: 9999px;
    font-size: 0.75rem;
    font-weight: 500;
}

.source-file-content {
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.3s ease;
}

.source-file.expanded .source-file-content {
    max-height: none;
}

.source-file-stats {
    padding: 0.75rem 1rem;
    border-bottom: 1px solid var(--gray-200);
    font-size: 0.875rem;
    color: var(--text-light);
}

/* Code styling */
.code-container {
    position: relative;
    overflow: auto;
    max-height: 600px;
}

.code-coverage-table {
    border-collapse: collapse;
    font-family: 'Roboto Mono', monospace;
    font-size: 0.8125rem;
    line-height: 1.5;
    tab-size: 4;
    width: 100%;
}

.code-coverage-table pre {
    margin: 0;
    font-family: inherit;
}

.row-line-number {
    user-select: none;
    text-align: right;
    padding: 0 0.75rem;
    width: 1%;
    min-width: 2.5rem;
    color: var(--gray-400);
    background: var(--gray-100);
    border-right: 1px solid var(--gray-200);
}

.row-reverted-status {
    user-select: none;
    text-align: center;
    width: 1%;
    min-width: 2.25rem;
    max-width: fit-content;
    padding: 0 0.25rem;
    color: var(--gray-600);
    background: var(--gray-100);
    border-right: 1px solid var(--gray-200);
    white-space: nowrap;
}

.row-source {
    padding: 0 0.75rem;
}

.row-line-covered {
    background: rgba(var(--success-rgb), 0.1);
}

.row-line-uncovered {
    background: rgba(var(--danger-rgb), 0.1);
}

/* Footer */
footer {
    background: var(--surface);
    border-top: 1px solid var(--gray-200);
    padding: 1rem;
    text-align: center;
    font-size: 0.875rem;
    color: var(--gray-500);
}

/* Responsive */
@media (max-width: 768px) {
    .stats-container { grid-template-columns: 1fr; }
    #file-explorer { display: none; }
}    </style>
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header>
            <div class="header-content">
                <span class="logo-text">Echidna Coverage Report</span>
            </div>
        </header>

        <!-- Main content -->
        <div class="split-panel" id="file-split-panel">
            <!-- File Explorer -->
            <div id="file-explorer">
                <div class="file-explorer-header">
                    <h3 class="file-explorer-title">Files</h3>
                </div>
                <div class="file-search">
                    <input type="text" id="file-search-input" placeholder="Search files..." />
                    <button id="file-search-clear" title="Clear search">Ã—</button>
                </div>
                <div class="file-explorer-content">
                    <ul id="file-tree-root" class="file-tree"></ul>
                    <div id="search-no-results" class="search-no-results" style="display: none;">No matching files found</div>
                </div>
                <div id="file-explorer-resizer"></div>
            </div>

            <!-- Main panel -->
            <div id="main-view-panel">
                <!-- Overview -->
                <div class="stats-container">
                    <div class="stat-card">
                        <div class="stat-title">Files</div>
                        <div class="stat-value">7</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-title">Total Lines</div>
                        <div class="stat-value">805</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-title">Coverage</div>
                        <div class="stat-value">86.0%</div>
                        <div class="progress-container">
                            <div class="progress-bar" style="width: 86.0%; background-color: hsl(103, 90%, 45%)"></div>
                        </div>
                        <div style="margin-top: 0.5rem">
                            <span class="stat-badge">186 / 214 lines</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-title">Actions</div>
                        <div class="button-group">
                            <button class="btn btn-secondary btn-sm" onclick="setAllSourceFilesCollapsed(false)">Expand All</button>
                            <button class="btn btn-secondary btn-sm" onclick="setAllSourceFilesCollapsed(true)">Collapse All</button>
                        </div>
                        <div class="button-group" style="margin-top: 0.5rem">
                            <button class="btn btn-secondary btn-sm" onclick="setEmptySourceFilesCollapsed(false)">Expand Empty</button>
                            <button class="btn btn-secondary btn-sm" onclick="setEmptySourceFilesCollapsed(true)">Collapse Empty</button>
                        </div>
                    </div>
                </div>

                <!-- Individual file coverage -->
                <div class="source-file" id="lib_openzeppelin_contracts_contracts_utils_Address_sol" data-file-path="lib/openzeppelin-contracts/contracts/utils/Address.sol" data-lines-active="20" data-lines-covered="17">
                    <div class="source-file-header">
                        <div class="file-info">
                            <span class="coverage-badge" style="background-color: hsla(102, 90%, 45%, 0.15); color: hsl(102, 90%, 45%)">
                                85.0%
                            </span>
                            <span class="file-name">lib/openzeppelin-contracts/contracts/utils/Address.sol</span>
                        </div>
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="chevron-icon">
                            <polyline points="6 9 12 15 18 9"></polyline>
                        </svg>
                    </div>
                    <div class="source-file-content">
                        <div class="source-file-stats">
                            <span>Lines covered: <strong>17 / 20</strong> (85.0%)</span>
                        </div>
                        <div class="code-container">
                            <table class="code-coverage-table">
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">1</td>
                                    <td class="row-source"><pre>// SPDX-License-Identifier: MIT</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">2</td>
                                    <td class="row-source"><pre>// OpenZeppelin Contracts (last updated v5.4.0) (utils/Address.sol)</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">3</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">4</td>
                                    <td class="row-source"><pre>pragma solidity ^0.8.20;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">5</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">6</td>
                                    <td class="row-source"><pre>import {Errors} from &quot;./Errors.sol&quot;;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">7</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">8</td>
                                    <td class="row-source"><pre>/**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">9</td>
                                    <td class="row-source"><pre> * @dev Collection of functions related to the address type</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">10</td>
                                    <td class="row-source"><pre> */</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">11</td>
                                    <td class="row-source"><pre>library Address {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">12</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">13</td>
                                    <td class="row-source"><pre>     * @dev There&#39;s no code at `target` (it is not a contract).</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">14</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">15</td>
                                    <td class="row-source"><pre>    error AddressEmptyCode(address target);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">16</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">17</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">18</td>
                                    <td class="row-source"><pre>     * @dev Replacement for Solidity&#39;s `transfer`: sends `amount` wei to</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">19</td>
                                    <td class="row-source"><pre>     * `recipient`, forwarding all available gas and reverting on errors.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">20</td>
                                    <td class="row-source"><pre>     *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">21</td>
                                    <td class="row-source"><pre>     * https://eips.ethereum.org/EIPS/eip-1884[EIP1884] increases the gas cost</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">22</td>
                                    <td class="row-source"><pre>     * of certain opcodes, possibly making contracts go over the 2300 gas limit</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">23</td>
                                    <td class="row-source"><pre>     * imposed by `transfer`, making them unable to receive funds via</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">24</td>
                                    <td class="row-source"><pre>     * `transfer`. {sendValue} removes this limitation.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">25</td>
                                    <td class="row-source"><pre>     *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">26</td>
                                    <td class="row-source"><pre>     * https://consensys.net/diligence/blog/2019/09/stop-using-soliditys-transfer-now/[Learn more].</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">27</td>
                                    <td class="row-source"><pre>     *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">28</td>
                                    <td class="row-source"><pre>     * IMPORTANT: because control is transferred to `recipient`, care must be</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">29</td>
                                    <td class="row-source"><pre>     * taken to not create reentrancy vulnerabilities. Consider using</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">30</td>
                                    <td class="row-source"><pre>     * {ReentrancyGuard} or the</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">31</td>
                                    <td class="row-source"><pre>     * https://solidity.readthedocs.io/en/v0.8.20/security-considerations.html#use-the-checks-effects-interactions-pattern[checks-effects-interactions pattern].</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">32</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">33</td>
                                    <td class="row-source"><pre>    function sendValue(address payable recipient, uint256 amount) internal {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">34</td>
                                    <td class="row-source"><pre>        if (address(this).balance &lt; amount) {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">35</td>
                                    <td class="row-source"><pre>            revert Errors.InsufficientBalance(address(this).balance, amount);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">36</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">37</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">38</td>
                                    <td class="row-source"><pre>        (bool success, bytes memory returndata) = recipient.call{value: amount}(&quot;&quot;);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">39</td>
                                    <td class="row-source"><pre>        if (!success) {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">40</td>
                                    <td class="row-source"><pre>            _revert(returndata);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">41</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">42</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">43</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">44</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">45</td>
                                    <td class="row-source"><pre>     * @dev Performs a Solidity function call using a low level `call`. A</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">46</td>
                                    <td class="row-source"><pre>     * plain `call` is an unsafe replacement for a function call: use this</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">47</td>
                                    <td class="row-source"><pre>     * function instead.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">48</td>
                                    <td class="row-source"><pre>     *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">49</td>
                                    <td class="row-source"><pre>     * If `target` reverts with a revert reason or custom error, it is bubbled</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">50</td>
                                    <td class="row-source"><pre>     * up by this function (like regular Solidity function calls). However, if</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">51</td>
                                    <td class="row-source"><pre>     * the call reverted with no returned reason, this function reverts with a</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">52</td>
                                    <td class="row-source"><pre>     * {Errors.FailedCall} error.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">53</td>
                                    <td class="row-source"><pre>     *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">54</td>
                                    <td class="row-source"><pre>     * Returns the raw returned data. To convert to the expected return value,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">55</td>
                                    <td class="row-source"><pre>     * use https://solidity.readthedocs.io/en/latest/units-and-global-variables.html?highlight=abi.decode#abi-encoding-and-decoding-functions[`abi.decode`].</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">56</td>
                                    <td class="row-source"><pre>     *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">57</td>
                                    <td class="row-source"><pre>     * Requirements:</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">58</td>
                                    <td class="row-source"><pre>     *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">59</td>
                                    <td class="row-source"><pre>     * - `target` must be a contract.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">60</td>
                                    <td class="row-source"><pre>     * - calling `target` with `data` must not revert.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">61</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">62</td>
                                    <td class="row-source"><pre>    function functionCall(address target, bytes memory data) internal returns (bytes memory) {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">63</td>
                                    <td class="row-source"><pre>        return functionCallWithValue(target, data, 0);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">64</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">65</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">66</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">67</td>
                                    <td class="row-source"><pre>     * @dev Same as {xref-Address-functionCall-address-bytes-}[`functionCall`],</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">68</td>
                                    <td class="row-source"><pre>     * but also transferring `value` wei to `target`.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">69</td>
                                    <td class="row-source"><pre>     *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">70</td>
                                    <td class="row-source"><pre>     * Requirements:</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">71</td>
                                    <td class="row-source"><pre>     *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">72</td>
                                    <td class="row-source"><pre>     * - the calling contract must have an ETH balance of at least `value`.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">73</td>
                                    <td class="row-source"><pre>     * - the called Solidity function must be `payable`.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">74</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">75</td>
                                    <td class="row-source"><pre>    function functionCallWithValue(address target, bytes memory data, uint256 value) internal returns (bytes memory) {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">76</td>
                                    <td class="row-source"><pre>        if (address(this).balance &lt; value) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">77</td>
                                    <td class="row-source"><pre>            revert Errors.InsufficientBalance(address(this).balance, value);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">78</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">79</td>
                                    <td class="row-source"><pre>        (bool success, bytes memory returndata) = target.call{value: value}(data);</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">80</td>
                                    <td class="row-source"><pre>        return verifyCallResultFromTarget(target, success, returndata);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">81</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">82</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">83</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">84</td>
                                    <td class="row-source"><pre>     * @dev Same as {xref-Address-functionCall-address-bytes-}[`functionCall`],</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">85</td>
                                    <td class="row-source"><pre>     * but performing a static call.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">86</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">87</td>
                                    <td class="row-source"><pre>    function functionStaticCall(address target, bytes memory data) internal view returns (bytes memory) {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">88</td>
                                    <td class="row-source"><pre>        (bool success, bytes memory returndata) = target.staticcall(data);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">89</td>
                                    <td class="row-source"><pre>        return verifyCallResultFromTarget(target, success, returndata);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">90</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">91</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">92</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">93</td>
                                    <td class="row-source"><pre>     * @dev Same as {xref-Address-functionCall-address-bytes-}[`functionCall`],</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">94</td>
                                    <td class="row-source"><pre>     * but performing a delegate call.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">95</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">96</td>
                                    <td class="row-source"><pre>    function functionDelegateCall(address target, bytes memory data) internal returns (bytes memory) {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">97</td>
                                    <td class="row-source"><pre>        (bool success, bytes memory returndata) = target.delegatecall(data);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">98</td>
                                    <td class="row-source"><pre>        return verifyCallResultFromTarget(target, success, returndata);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">99</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">100</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">101</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">102</td>
                                    <td class="row-source"><pre>     * @dev Tool to verify that a low level call to smart-contract was successful, and reverts if the target</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">103</td>
                                    <td class="row-source"><pre>     * was not a contract or bubbling up the revert reason (falling back to {Errors.FailedCall}) in case</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">104</td>
                                    <td class="row-source"><pre>     * of an unsuccessful call.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">105</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">106</td>
                                    <td class="row-source"><pre>    function verifyCallResultFromTarget(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">107</td>
                                    <td class="row-source"><pre>        address target,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">108</td>
                                    <td class="row-source"><pre>        bool success,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">109</td>
                                    <td class="row-source"><pre>        bytes memory returndata</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">110</td>
                                    <td class="row-source"><pre>    ) internal view returns (bytes memory) {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">111</td>
                                    <td class="row-source"><pre>        if (!success) {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">112</td>
                                    <td class="row-source"><pre>            _revert(returndata);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">113</td>
                                    <td class="row-source"><pre>        } else {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">114</td>
                                    <td class="row-source"><pre>            // only check if target is a contract if the call was successful and the return data is empty</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">115</td>
                                    <td class="row-source"><pre>            // otherwise we already know that it was a contract</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">116</td>
                                    <td class="row-source"><pre>            if (returndata.length == 0 &amp;&amp; target.code.length == 0) {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">117</td>
                                    <td class="row-source"><pre>                revert AddressEmptyCode(target);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">118</td>
                                    <td class="row-source"><pre>            }</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">119</td>
                                    <td class="row-source"><pre>            return returndata;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">120</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">121</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">122</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">123</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">124</td>
                                    <td class="row-source"><pre>     * @dev Tool to verify that a low level call was successful, and reverts if it wasn&#39;t, either by bubbling the</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">125</td>
                                    <td class="row-source"><pre>     * revert reason or with a default {Errors.FailedCall} error.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">126</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">127</td>
                                    <td class="row-source"><pre>    function verifyCallResult(bool success, bytes memory returndata) internal pure returns (bytes memory) {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">128</td>
                                    <td class="row-source"><pre>        if (!success) {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">129</td>
                                    <td class="row-source"><pre>            _revert(returndata);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">130</td>
                                    <td class="row-source"><pre>        } else {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">131</td>
                                    <td class="row-source"><pre>            return returndata;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">132</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">133</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">134</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">135</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">136</td>
                                    <td class="row-source"><pre>     * @dev Reverts with returndata if present. Otherwise reverts with {Errors.FailedCall}.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">137</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">138</td>
                                    <td class="row-source"><pre>    function _revert(bytes memory returndata) private pure {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">139</td>
                                    <td class="row-source"><pre>        // Look for revert reason and bubble it up if present</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">140</td>
                                    <td class="row-source"><pre>        if (returndata.length &gt; 0) {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">141</td>
                                    <td class="row-source"><pre>            // The easiest way to bubble the revert reason is using memory via assembly</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">142</td>
                                    <td class="row-source"><pre>            assembly (&quot;memory-safe&quot;) {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">143</td>
                                    <td class="row-source"><pre>                revert(add(returndata, 0x20), mload(returndata))</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">144</td>
                                    <td class="row-source"><pre>            }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">145</td>
                                    <td class="row-source"><pre>        } else {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">146</td>
                                    <td class="row-source"><pre>            revert Errors.FailedCall();</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">147</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">148</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">149</td>
                                    <td class="row-source"><pre>}</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">150</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="source-file" id="lib_openzeppelin_contracts_contracts_utils_Errors_sol" data-file-path="lib/openzeppelin-contracts/contracts/utils/Errors.sol" data-lines-active="1" data-lines-covered="0">
                    <div class="source-file-header">
                        <div class="file-info">
                            <span class="coverage-badge" style="background-color: hsla(0, 90%, 50%, 0.15); color: hsl(0, 90%, 50%)">
                                0.0%
                            </span>
                            <span class="file-name">lib/openzeppelin-contracts/contracts/utils/Errors.sol</span>
                        </div>
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="chevron-icon">
                            <polyline points="6 9 12 15 18 9"></polyline>
                        </svg>
                    </div>
                    <div class="source-file-content">
                        <div class="source-file-stats">
                            <span>Lines covered: <strong>0 / 1</strong> (0.0%)</span>
                        </div>
                        <div class="code-container">
                            <table class="code-coverage-table">
                                <tr>
                                    <td class="row-line-number">1</td>
                                    <td class="row-source"><pre>// SPDX-License-Identifier: MIT</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">2</td>
                                    <td class="row-source"><pre>// OpenZeppelin Contracts (last updated v5.1.0) (utils/Errors.sol)</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">3</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">4</td>
                                    <td class="row-source"><pre>pragma solidity ^0.8.20;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">5</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">6</td>
                                    <td class="row-source"><pre>/**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">7</td>
                                    <td class="row-source"><pre> * @dev Collection of common custom errors used in multiple contracts</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">8</td>
                                    <td class="row-source"><pre> *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">9</td>
                                    <td class="row-source"><pre> * IMPORTANT: Backwards compatibility is not guaranteed in future versions of the library.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">10</td>
                                    <td class="row-source"><pre> * It is recommended to avoid relying on the error API for critical functionality.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">11</td>
                                    <td class="row-source"><pre> *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">12</td>
                                    <td class="row-source"><pre> * _Available since v5.1._</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">13</td>
                                    <td class="row-source"><pre> */</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">14</td>
                                    <td class="row-source"><pre>library Errors {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">15</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">16</td>
                                    <td class="row-source"><pre>     * @dev The ETH balance of the account is not enough to perform the operation.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">17</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">18</td>
                                    <td class="row-source"><pre>    error InsufficientBalance(uint256 balance, uint256 needed);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">19</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">20</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">21</td>
                                    <td class="row-source"><pre>     * @dev A call to an address target failed. The target may have reverted.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">22</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">23</td>
                                    <td class="row-source"><pre>    error FailedCall();</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">24</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">25</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">26</td>
                                    <td class="row-source"><pre>     * @dev The deployment failed.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">27</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">28</td>
                                    <td class="row-source"><pre>    error FailedDeployment();</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">29</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">30</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">31</td>
                                    <td class="row-source"><pre>     * @dev A necessary precompile is missing.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">32</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">33</td>
                                    <td class="row-source"><pre>    error MissingPrecompile(address);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">34</td>
                                    <td class="row-source"><pre>}</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">35</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="source-file" id="lib_openzeppelin_contracts_contracts_utils_ReentrancyGuard_sol" data-file-path="lib/openzeppelin-contracts/contracts/utils/ReentrancyGuard.sol" data-lines-active="11" data-lines-covered="11">
                    <div class="source-file-header">
                        <div class="file-info">
                            <span class="coverage-badge" style="background-color: hsla(120, 90%, 45%, 0.15); color: hsl(120, 90%, 45%)">
                                100.0%
                            </span>
                            <span class="file-name">lib/openzeppelin-contracts/contracts/utils/ReentrancyGuard.sol</span>
                        </div>
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="chevron-icon">
                            <polyline points="6 9 12 15 18 9"></polyline>
                        </svg>
                    </div>
                    <div class="source-file-content">
                        <div class="source-file-stats">
                            <span>Lines covered: <strong>11 / 11</strong> (100.0%)</span>
                        </div>
                        <div class="code-container">
                            <table class="code-coverage-table">
                                <tr>
                                    <td class="row-line-number">1</td>
                                    <td class="row-source"><pre>// SPDX-License-Identifier: MIT</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">2</td>
                                    <td class="row-source"><pre>// OpenZeppelin Contracts (last updated v5.1.0) (utils/ReentrancyGuard.sol)</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">3</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">4</td>
                                    <td class="row-source"><pre>pragma solidity ^0.8.20;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">5</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">6</td>
                                    <td class="row-source"><pre>/**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">7</td>
                                    <td class="row-source"><pre> * @dev Contract module that helps prevent reentrant calls to a function.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">8</td>
                                    <td class="row-source"><pre> *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">9</td>
                                    <td class="row-source"><pre> * Inheriting from `ReentrancyGuard` will make the {nonReentrant} modifier</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">10</td>
                                    <td class="row-source"><pre> * available, which can be applied to functions to make sure there are no nested</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">11</td>
                                    <td class="row-source"><pre> * (reentrant) calls to them.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">12</td>
                                    <td class="row-source"><pre> *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">13</td>
                                    <td class="row-source"><pre> * Note that because there is a single `nonReentrant` guard, functions marked as</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">14</td>
                                    <td class="row-source"><pre> * `nonReentrant` may not call one another. This can be worked around by making</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">15</td>
                                    <td class="row-source"><pre> * those functions `private`, and then adding `external` `nonReentrant` entry</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">16</td>
                                    <td class="row-source"><pre> * points to them.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">17</td>
                                    <td class="row-source"><pre> *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">18</td>
                                    <td class="row-source"><pre> * TIP: If EIP-1153 (transient storage) is available on the chain you&#39;re deploying at,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">19</td>
                                    <td class="row-source"><pre> * consider using {ReentrancyGuardTransient} instead.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">20</td>
                                    <td class="row-source"><pre> *</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">21</td>
                                    <td class="row-source"><pre> * TIP: If you would like to learn more about reentrancy and alternative ways</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">22</td>
                                    <td class="row-source"><pre> * to protect against it, check out our blog post</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">23</td>
                                    <td class="row-source"><pre> * https://blog.openzeppelin.com/reentrancy-after-istanbul/[Reentrancy After Istanbul].</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">24</td>
                                    <td class="row-source"><pre> */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">25</td>
                                    <td class="row-source"><pre>abstract contract ReentrancyGuard {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">26</td>
                                    <td class="row-source"><pre>    // Booleans are more expensive than uint256 or any type that takes up a full</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">27</td>
                                    <td class="row-source"><pre>    // word because each write operation emits an extra SLOAD to first read the</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">28</td>
                                    <td class="row-source"><pre>    // slot&#39;s contents, replace the bits taken up by the boolean, and then write</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">29</td>
                                    <td class="row-source"><pre>    // back. This is the compiler&#39;s defense against contract upgrades and</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">30</td>
                                    <td class="row-source"><pre>    // pointer aliasing, and it cannot be disabled.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">31</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">32</td>
                                    <td class="row-source"><pre>    // The values being non-zero value makes deployment a bit more expensive,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">33</td>
                                    <td class="row-source"><pre>    // but in exchange the refund on every call to nonReentrant will be lower in</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">34</td>
                                    <td class="row-source"><pre>    // amount. Since refunds are capped to a percentage of the total</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">35</td>
                                    <td class="row-source"><pre>    // transaction&#39;s gas, it is best to keep them low in cases like this one, to</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">36</td>
                                    <td class="row-source"><pre>    // increase the likelihood of the full refund coming into effect.</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">37</td>
                                    <td class="row-source"><pre>    uint256 private constant NOT_ENTERED = 1;</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">38</td>
                                    <td class="row-source"><pre>    uint256 private constant ENTERED = 2;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">39</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">40</td>
                                    <td class="row-source"><pre>    uint256 private _status;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">41</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">42</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">43</td>
                                    <td class="row-source"><pre>     * @dev Unauthorized reentrant call.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">44</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">45</td>
                                    <td class="row-source"><pre>    error ReentrancyGuardReentrantCall();</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">46</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">47</td>
                                    <td class="row-source"><pre>    constructor() {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">48</td>
                                    <td class="row-source"><pre>        _status = NOT_ENTERED;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">49</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">50</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">51</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">52</td>
                                    <td class="row-source"><pre>     * @dev Prevents a contract from calling itself, directly or indirectly.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">53</td>
                                    <td class="row-source"><pre>     * Calling a `nonReentrant` function from another `nonReentrant`</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">54</td>
                                    <td class="row-source"><pre>     * function is not supported. It is possible to prevent this from happening</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">55</td>
                                    <td class="row-source"><pre>     * by making the `nonReentrant` function external, and making it call a</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">56</td>
                                    <td class="row-source"><pre>     * `private` function that does the actual work.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">57</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">58</td>
                                    <td class="row-source"><pre>    modifier nonReentrant() {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">59</td>
                                    <td class="row-source"><pre>        _nonReentrantBefore();</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">60</td>
                                    <td class="row-source"><pre>        _;</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">61</td>
                                    <td class="row-source"><pre>        _nonReentrantAfter();</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">62</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">63</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">64</td>
                                    <td class="row-source"><pre>    function _nonReentrantBefore() private {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">65</td>
                                    <td class="row-source"><pre>        // On the first call to nonReentrant, _status will be NOT_ENTERED</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">66</td>
                                    <td class="row-source"><pre>        if (_status == ENTERED) {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">67</td>
                                    <td class="row-source"><pre>            revert ReentrancyGuardReentrantCall();</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">68</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">69</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">70</td>
                                    <td class="row-source"><pre>        // Any calls to nonReentrant after this point will fail</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">71</td>
                                    <td class="row-source"><pre>        _status = ENTERED;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">72</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">73</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">74</td>
                                    <td class="row-source"><pre>    function _nonReentrantAfter() private {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">75</td>
                                    <td class="row-source"><pre>        // By storing the original value once again, a refund is triggered (see</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">76</td>
                                    <td class="row-source"><pre>        // https://eips.ethereum.org/EIPS/eip-2200)</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">77</td>
                                    <td class="row-source"><pre>        _status = NOT_ENTERED;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">78</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">79</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">80</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">81</td>
                                    <td class="row-source"><pre>     * @dev Returns true if the reentrancy guard is currently set to &quot;entered&quot;, which indicates there is a</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">82</td>
                                    <td class="row-source"><pre>     * `nonReentrant` function in the call stack.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">83</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">84</td>
                                    <td class="row-source"><pre>    function _reentrancyGuardEntered() internal view returns (bool) {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">85</td>
                                    <td class="row-source"><pre>        return _status == ENTERED;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">86</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">87</td>
                                    <td class="row-source"><pre>}</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">88</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="source-file" id="lib_solmate_src_tokens_ERC20_sol" data-file-path="lib/solmate/src/tokens/ERC20.sol" data-lines-active="66" data-lines-covered="58">
                    <div class="source-file-header">
                        <div class="file-info">
                            <span class="coverage-badge" style="background-color: hsla(104, 90%, 45%, 0.15); color: hsl(104, 90%, 45%)">
                                87.0%
                            </span>
                            <span class="file-name">lib/solmate/src/tokens/ERC20.sol</span>
                        </div>
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="chevron-icon">
                            <polyline points="6 9 12 15 18 9"></polyline>
                        </svg>
                    </div>
                    <div class="source-file-content">
                        <div class="source-file-stats">
                            <span>Lines covered: <strong>58 / 66</strong> (87.0%)</span>
                        </div>
                        <div class="code-container">
                            <table class="code-coverage-table">
                                <tr>
                                    <td class="row-line-number">1</td>
                                    <td class="row-source"><pre>// SPDX-License-Identifier: AGPL-3.0-only</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">2</td>
                                    <td class="row-source"><pre>pragma solidity &gt;=0.8.0;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">3</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">4</td>
                                    <td class="row-source"><pre>/// @notice Modern and gas efficient ERC20 + EIP-2612 implementation.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">5</td>
                                    <td class="row-source"><pre>/// @author Solmate (https://github.com/transmissions11/solmate/blob/main/src/tokens/ERC20.sol)</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">6</td>
                                    <td class="row-source"><pre>/// @author Modified from Uniswap (https://github.com/Uniswap/uniswap-v2-core/blob/master/contracts/UniswapV2ERC20.sol)</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">7</td>
                                    <td class="row-source"><pre>/// @dev Do not manually set balances without updating totalSupply, as the sum of all user balances must not exceed it.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">8</td>
                                    <td class="row-source"><pre>abstract contract ERC20 {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">9</td>
                                    <td class="row-source"><pre>    /*//////////////////////////////////////////////////////////////</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">10</td>
                                    <td class="row-source"><pre>                                 EVENTS</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">11</td>
                                    <td class="row-source"><pre>    //////////////////////////////////////////////////////////////*/</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">12</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">13</td>
                                    <td class="row-source"><pre>    event Transfer(address indexed from, address indexed to, uint256 amount);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">14</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">15</td>
                                    <td class="row-source"><pre>    event Approval(address indexed owner, address indexed spender, uint256 amount);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">16</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">17</td>
                                    <td class="row-source"><pre>    /*//////////////////////////////////////////////////////////////</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">18</td>
                                    <td class="row-source"><pre>                            METADATA STORAGE</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">19</td>
                                    <td class="row-source"><pre>    //////////////////////////////////////////////////////////////*/</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">20</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">21</td>
                                    <td class="row-source"><pre>    string public name;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">22</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">23</td>
                                    <td class="row-source"><pre>    string public symbol;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">24</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">25</td>
                                    <td class="row-source"><pre>    uint8 public immutable decimals;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">26</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">27</td>
                                    <td class="row-source"><pre>    /*//////////////////////////////////////////////////////////////</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">28</td>
                                    <td class="row-source"><pre>                              ERC20 STORAGE</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">29</td>
                                    <td class="row-source"><pre>    //////////////////////////////////////////////////////////////*/</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">30</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">31</td>
                                    <td class="row-source"><pre>    uint256 public totalSupply;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">32</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">33</td>
                                    <td class="row-source"><pre>    mapping(address =&gt; uint256) public balanceOf;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">34</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">35</td>
                                    <td class="row-source"><pre>    mapping(address =&gt; mapping(address =&gt; uint256)) public allowance;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">36</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">37</td>
                                    <td class="row-source"><pre>    /*//////////////////////////////////////////////////////////////</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">38</td>
                                    <td class="row-source"><pre>                            EIP-2612 STORAGE</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">39</td>
                                    <td class="row-source"><pre>    //////////////////////////////////////////////////////////////*/</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">40</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">41</td>
                                    <td class="row-source"><pre>    uint256 internal immutable INITIAL_CHAIN_ID;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">42</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">43</td>
                                    <td class="row-source"><pre>    bytes32 internal immutable INITIAL_DOMAIN_SEPARATOR;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">44</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">45</td>
                                    <td class="row-source"><pre>    mapping(address =&gt; uint256) public nonces;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">46</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">47</td>
                                    <td class="row-source"><pre>    /*//////////////////////////////////////////////////////////////</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">48</td>
                                    <td class="row-source"><pre>                               CONSTRUCTOR</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">49</td>
                                    <td class="row-source"><pre>    //////////////////////////////////////////////////////////////*/</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">50</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">51</td>
                                    <td class="row-source"><pre>    constructor(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">52</td>
                                    <td class="row-source"><pre>        string memory _name,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">53</td>
                                    <td class="row-source"><pre>        string memory _symbol,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">54</td>
                                    <td class="row-source"><pre>        uint8 _decimals</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">55</td>
                                    <td class="row-source"><pre>    ) {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">56</td>
                                    <td class="row-source"><pre>        name = _name;</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">57</td>
                                    <td class="row-source"><pre>        symbol = _symbol;</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">58</td>
                                    <td class="row-source"><pre>        decimals = _decimals;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">59</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">60</td>
                                    <td class="row-source"><pre>        INITIAL_CHAIN_ID = block.chainid;</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">61</td>
                                    <td class="row-source"><pre>        INITIAL_DOMAIN_SEPARATOR = computeDomainSeparator();</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">62</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">63</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">64</td>
                                    <td class="row-source"><pre>    /*//////////////////////////////////////////////////////////////</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">65</td>
                                    <td class="row-source"><pre>                               ERC20 LOGIC</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">66</td>
                                    <td class="row-source"><pre>    //////////////////////////////////////////////////////////////*/</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">67</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">68</td>
                                    <td class="row-source"><pre>    function approve(address spender, uint256 amount) public virtual returns (bool) {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">69</td>
                                    <td class="row-source"><pre>        allowance[msg.sender][spender] = amount;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">70</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">71</td>
                                    <td class="row-source"><pre>        emit Approval(msg.sender, spender, amount);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">72</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">73</td>
                                    <td class="row-source"><pre>        return true;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">74</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">75</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">76</td>
                                    <td class="row-source"><pre>    function transfer(address to, uint256 amount) public virtual returns (bool) {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">77</td>
                                    <td class="row-source"><pre>        balanceOf[msg.sender] -= amount;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">78</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">79</td>
                                    <td class="row-source"><pre>        // Cannot overflow because the sum of all user</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">80</td>
                                    <td class="row-source"><pre>        // balances can&#39;t exceed the max uint256 value.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">81</td>
                                    <td class="row-source"><pre>        unchecked {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">82</td>
                                    <td class="row-source"><pre>            balanceOf[to] += amount;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">83</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">84</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">85</td>
                                    <td class="row-source"><pre>        emit Transfer(msg.sender, to, amount);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">86</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">87</td>
                                    <td class="row-source"><pre>        return true;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">88</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">89</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">90</td>
                                    <td class="row-source"><pre>    function transferFrom(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">91</td>
                                    <td class="row-source"><pre>        address from,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">92</td>
                                    <td class="row-source"><pre>        address to,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">93</td>
                                    <td class="row-source"><pre>        uint256 amount</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">94</td>
                                    <td class="row-source"><pre>    ) public virtual returns (bool) {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">95</td>
                                    <td class="row-source"><pre>        uint256 allowed = allowance[from][msg.sender]; // Saves gas for limited approvals.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">96</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">97</td>
                                    <td class="row-source"><pre>        if (allowed != type(uint256).max) allowance[from][msg.sender] = allowed - amount;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">98</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">99</td>
                                    <td class="row-source"><pre>        balanceOf[from] -= amount;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">100</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">101</td>
                                    <td class="row-source"><pre>        // Cannot overflow because the sum of all user</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">102</td>
                                    <td class="row-source"><pre>        // balances can&#39;t exceed the max uint256 value.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">103</td>
                                    <td class="row-source"><pre>        unchecked {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">104</td>
                                    <td class="row-source"><pre>            balanceOf[to] += amount;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">105</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">106</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">107</td>
                                    <td class="row-source"><pre>        emit Transfer(from, to, amount);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">108</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">109</td>
                                    <td class="row-source"><pre>        return true;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">110</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">111</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">112</td>
                                    <td class="row-source"><pre>    /*//////////////////////////////////////////////////////////////</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">113</td>
                                    <td class="row-source"><pre>                             EIP-2612 LOGIC</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">114</td>
                                    <td class="row-source"><pre>    //////////////////////////////////////////////////////////////*/</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">115</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">116</td>
                                    <td class="row-source"><pre>    function permit(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">117</td>
                                    <td class="row-source"><pre>        address owner,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">118</td>
                                    <td class="row-source"><pre>        address spender,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">119</td>
                                    <td class="row-source"><pre>        uint256 value,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">120</td>
                                    <td class="row-source"><pre>        uint256 deadline,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">121</td>
                                    <td class="row-source"><pre>        uint8 v,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">122</td>
                                    <td class="row-source"><pre>        bytes32 r,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">123</td>
                                    <td class="row-source"><pre>        bytes32 s</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">124</td>
                                    <td class="row-source"><pre>    ) public virtual {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">125</td>
                                    <td class="row-source"><pre>        require(deadline &gt;= block.timestamp, &quot;PERMIT_DEADLINE_EXPIRED&quot;);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">126</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">127</td>
                                    <td class="row-source"><pre>        // Unchecked because the only math done is incrementing</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">128</td>
                                    <td class="row-source"><pre>        // the owner&#39;s nonce which cannot realistically overflow.</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">129</td>
                                    <td class="row-source"><pre>        unchecked {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">130</td>
                                    <td class="row-source"><pre>            address recoveredAddress = ecrecover(</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">131</td>
                                    <td class="row-source"><pre>                keccak256(</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">132</td>
                                    <td class="row-source"><pre>                    abi.encodePacked(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">133</td>
                                    <td class="row-source"><pre>                        &quot;\x19\x01&quot;,</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">134</td>
                                    <td class="row-source"><pre>                        DOMAIN_SEPARATOR(),</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">135</td>
                                    <td class="row-source"><pre>                        keccak256(</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">136</td>
                                    <td class="row-source"><pre>                            abi.encode(</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">137</td>
                                    <td class="row-source"><pre>                                keccak256(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">138</td>
                                    <td class="row-source"><pre>                                    &quot;Permit(address owner,address spender,uint256 value,uint256 nonce,uint256 deadline)&quot;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">139</td>
                                    <td class="row-source"><pre>                                ),</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">140</td>
                                    <td class="row-source"><pre>                                owner,</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">141</td>
                                    <td class="row-source"><pre>                                spender,</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">142</td>
                                    <td class="row-source"><pre>                                value,</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">143</td>
                                    <td class="row-source"><pre>                                nonces[owner]++,</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">144</td>
                                    <td class="row-source"><pre>                                deadline</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">145</td>
                                    <td class="row-source"><pre>                            )</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">146</td>
                                    <td class="row-source"><pre>                        )</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">147</td>
                                    <td class="row-source"><pre>                    )</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">148</td>
                                    <td class="row-source"><pre>                ),</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">149</td>
                                    <td class="row-source"><pre>                v,</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">150</td>
                                    <td class="row-source"><pre>                r,</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">151</td>
                                    <td class="row-source"><pre>                s</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">152</td>
                                    <td class="row-source"><pre>            );</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">153</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">154</td>
                                    <td class="row-source"><pre>            require(recoveredAddress != address(0) &amp;&amp; recoveredAddress == owner, &quot;INVALID_SIGNER&quot;);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">155</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">156</td>
                                    <td class="row-source"><pre>            allowance[recoveredAddress][spender] = value;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">157</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">158</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">159</td>
                                    <td class="row-source"><pre>        emit Approval(owner, spender, value);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">160</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">161</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">162</td>
                                    <td class="row-source"><pre>    function DOMAIN_SEPARATOR() public view virtual returns (bytes32) {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">163</td>
                                    <td class="row-source"><pre>        return block.chainid == INITIAL_CHAIN_ID ? INITIAL_DOMAIN_SEPARATOR : computeDomainSeparator();</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">164</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">165</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">166</td>
                                    <td class="row-source"><pre>    function computeDomainSeparator() internal view virtual returns (bytes32) {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">167</td>
                                    <td class="row-source"><pre>        return</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">168</td>
                                    <td class="row-source"><pre>            keccak256(</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">169</td>
                                    <td class="row-source"><pre>                abi.encode(</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">170</td>
                                    <td class="row-source"><pre>                    keccak256(&quot;EIP712Domain(string name,string version,uint256 chainId,address verifyingContract)&quot;),</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">171</td>
                                    <td class="row-source"><pre>                    keccak256(bytes(name)),</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">172</td>
                                    <td class="row-source"><pre>                    keccak256(&quot;1&quot;),</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">173</td>
                                    <td class="row-source"><pre>                    block.chainid,</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">174</td>
                                    <td class="row-source"><pre>                    address(this)</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">175</td>
                                    <td class="row-source"><pre>                )</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">176</td>
                                    <td class="row-source"><pre>            );</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">177</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">178</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">179</td>
                                    <td class="row-source"><pre>    /*//////////////////////////////////////////////////////////////</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">180</td>
                                    <td class="row-source"><pre>                        INTERNAL MINT/BURN LOGIC</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">181</td>
                                    <td class="row-source"><pre>    //////////////////////////////////////////////////////////////*/</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">182</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">183</td>
                                    <td class="row-source"><pre>    function _mint(address to, uint256 amount) internal virtual {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">184</td>
                                    <td class="row-source"><pre>        totalSupply += amount;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">185</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">186</td>
                                    <td class="row-source"><pre>        // Cannot overflow because the sum of all user</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">187</td>
                                    <td class="row-source"><pre>        // balances can&#39;t exceed the max uint256 value.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">188</td>
                                    <td class="row-source"><pre>        unchecked {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">189</td>
                                    <td class="row-source"><pre>            balanceOf[to] += amount;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">190</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">191</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">192</td>
                                    <td class="row-source"><pre>        emit Transfer(address(0), to, amount);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">193</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">194</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">195</td>
                                    <td class="row-source"><pre>    function _burn(address from, uint256 amount) internal virtual {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">196</td>
                                    <td class="row-source"><pre>        balanceOf[from] -= amount;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">197</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">198</td>
                                    <td class="row-source"><pre>        // Cannot underflow because a user&#39;s balance</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">199</td>
                                    <td class="row-source"><pre>        // will never be larger than the total supply.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">200</td>
                                    <td class="row-source"><pre>        unchecked {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">201</td>
                                    <td class="row-source"><pre>            totalSupply -= amount;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">202</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">203</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">204</td>
                                    <td class="row-source"><pre>        emit Transfer(from, address(0), amount);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">205</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">206</td>
                                    <td class="row-source"><pre>}</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">207</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="source-file" id="src_Token_sol" data-file-path="src/Token.sol" data-lines-active="6" data-lines-covered="6">
                    <div class="source-file-header">
                        <div class="file-info">
                            <span class="coverage-badge" style="background-color: hsla(120, 90%, 45%, 0.15); color: hsl(120, 90%, 45%)">
                                100.0%
                            </span>
                            <span class="file-name">src/Token.sol</span>
                        </div>
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="chevron-icon">
                            <polyline points="6 9 12 15 18 9"></polyline>
                        </svg>
                    </div>
                    <div class="source-file-content">
                        <div class="source-file-stats">
                            <span>Lines covered: <strong>6 / 6</strong> (100.0%)</span>
                        </div>
                        <div class="code-container">
                            <table class="code-coverage-table">
                                <tr>
                                    <td class="row-line-number">1</td>
                                    <td class="row-source"><pre>// SPDX-License-Identifier: UNLICENSED</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">2</td>
                                    <td class="row-source"><pre>pragma solidity ^0.8.19;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">3</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">4</td>
                                    <td class="row-source"><pre>import &quot;../lib/solmate/src/tokens/ERC20.sol&quot;;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">5</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">6</td>
                                    <td class="row-source"><pre>contract MyToken is ERC20 {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">7</td>
                                    <td class="row-source"><pre>    constructor(string memory _name, string memory _symbol) ERC20(_name, _symbol, 18) {}</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">8</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">9</td>
                                    <td class="row-source"><pre>    // simple mint for tests/fuzzing (anyone can mint in this test token)</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">10</td>
                                    <td class="row-source"><pre>    function mint(address to, uint256 amount) external {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">11</td>
                                    <td class="row-source"><pre>        _mint(to, amount);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">12</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">13</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">14</td>
                                    <td class="row-source"><pre>    // expose a convenience function wrapping transferFrom for easier calls in fuzz harness</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">15</td>
                                    <td class="row-source"><pre>    function safeTransferFrom(address from, address to, uint256 amount) external returns (bool) {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">16</td>
                                    <td class="row-source"><pre>        return transferFrom(from, to, amount);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">17</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">18</td>
                                    <td class="row-source"><pre>}</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">19</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">20</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="source-file" id="src_truster_TrusterLenderPool_sol" data-file-path="src/truster/TrusterLenderPool.sol" data-lines-active="33" data-lines-covered="29">
                    <div class="source-file-header">
                        <div class="file-info">
                            <span class="coverage-badge" style="background-color: hsla(104, 90%, 45%, 0.15); color: hsl(104, 90%, 45%)">
                                87.0%
                            </span>
                            <span class="file-name">src/truster/TrusterLenderPool.sol</span>
                        </div>
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="chevron-icon">
                            <polyline points="6 9 12 15 18 9"></polyline>
                        </svg>
                    </div>
                    <div class="source-file-content">
                        <div class="source-file-stats">
                            <span>Lines covered: <strong>29 / 33</strong> (87.0%)</span>
                        </div>
                        <div class="code-container">
                            <table class="code-coverage-table">
                                <tr>
                                    <td class="row-line-number">1</td>
                                    <td class="row-source"><pre>// SPDX-License-Identifier: MIT</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">2</td>
                                    <td class="row-source"><pre>// Damn Vulnerable DeFi v4 (https://damnvulnerabledefi.xyz)</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">3</td>
                                    <td class="row-source"><pre>pragma solidity ^0.8.20;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">4</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">5</td>
                                    <td class="row-source"><pre>import {Address} from &quot;@openzeppelin/contracts/utils/Address.sol&quot;;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">6</td>
                                    <td class="row-source"><pre>import {ReentrancyGuard} from &quot;@openzeppelin/contracts/utils/ReentrancyGuard.sol&quot;;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">7</td>
                                    <td class="row-source"><pre>import {MyToken} from &quot;../Token.sol&quot;;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">8</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">9</td>
                                    <td class="row-source"><pre>/**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">10</td>
                                    <td class="row-source"><pre> * @title TrusterLenderPoolChallenge</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">11</td>
                                    <td class="row-source"><pre> * @dev A challenge contract designed specifically for Echidna fuzzing</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">12</td>
                                    <td class="row-source"><pre> * </pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">13</td>
                                    <td class="row-source"><pre> * This contract contains multiple vulnerabilities that can be discovered</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">14</td>
                                    <td class="row-source"><pre> * through systematic fuzzing with Echidna.</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">15</td>
                                    <td class="row-source"><pre> */</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">16</td>
                                    <td class="row-source"><pre>contract TrusterLenderPool is ReentrancyGuard {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">17</td>
                                    <td class="row-source"><pre>    using Address for address;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">18</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">19</td>
                                    <td class="row-source"><pre>    MyToken public immutable token;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">20</td>
                                    <td class="row-source"><pre>    </pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">21</td>
                                    <td class="row-source"><pre>    // Challenge state tracking</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">22</td>
                                    <td class="row-source"><pre>    uint256 public totalFlashLoans;</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">23</td>
                                    <td class="row-source"><pre>    uint256 public totalRepayments;</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">24</td>
                                    <td class="row-source"><pre>    mapping(address =&gt; uint256) public borrowerDebts;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">25</td>
                                    <td class="row-source"><pre>    </pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">26</td>
                                    <td class="row-source"><pre>    // Events for tracking</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">27</td>
                                    <td class="row-source"><pre>    event FlashLoanIssued(address indexed borrower, uint256 amount);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">28</td>
                                    <td class="row-source"><pre>    event FlashLoanRepaid(address indexed borrower, uint256 amount);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">29</td>
                                    <td class="row-source"><pre>    event UnauthorizedCall(address indexed target, bytes data);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">30</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">31</td>
                                    <td class="row-source"><pre>    error RepayFailed();</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">32</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">33</td>
                                    <td class="row-source"><pre>    constructor(MyToken _token) {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">34</td>
                                    <td class="row-source"><pre>        token = _token;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">35</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">36</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">37</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">38</td>
                                    <td class="row-source"><pre>     * @dev Main vulnerability: Arbitrary external call without proper validation</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">39</td>
                                    <td class="row-source"><pre>     * This allows attackers to manipulate the token contract or other contracts</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">40</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">41</td>
                                    <td class="row-source"><pre>    function flashLoan(uint256 amount, address borrower, address target, bytes calldata data)</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">42</td>
                                    <td class="row-source"><pre>        external</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">43</td>
                                    <td class="row-source"><pre>        nonReentrant</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">44</td>
                                    <td class="row-source"><pre>        returns (bool)</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">45</td>
                                    <td class="row-source"><pre>    {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">46</td>
                                    <td class="row-source"><pre>        uint256 balanceBefore = token.balanceOf(address(this));</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">47</td>
                                    <td class="row-source"><pre>        </pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">48</td>
                                    <td class="row-source"><pre>        // Transfer tokens to borrower</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">49</td>
                                    <td class="row-source"><pre>        if (amount &gt; 0) {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">50</td>
                                    <td class="row-source"><pre>            token.transfer(borrower, amount);</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">51</td>
                                    <td class="row-source"><pre>            totalFlashLoans++;</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">52</td>
                                    <td class="row-source"><pre>            borrowerDebts[borrower] += amount;</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">53</td>
                                    <td class="row-source"><pre>            emit FlashLoanIssued(borrower, amount);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">54</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">55</td>
                                    <td class="row-source"><pre>        </pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">56</td>
                                    <td class="row-source"><pre>        // VULNERABILITY: Arbitrary external call</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">57</td>
                                    <td class="row-source"><pre>        // This allows attackers to call any function on any contract</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">58</td>
                                    <td class="row-source"><pre>        if (target != address(0) &amp;&amp; data.length &gt; 0) {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">59</td>
                                    <td class="row-source"><pre>            target.functionCall(data);</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">60</td>
                                    <td class="row-source"><pre>            emit UnauthorizedCall(target, data);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">61</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">62</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">63</td>
                                    <td class="row-source"><pre>        // Check repayment</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">64</td>
                                    <td class="row-source"><pre>        if (token.balanceOf(address(this)) &lt; balanceBefore) {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">65</td>
                                    <td class="row-source"><pre>            revert RepayFailed();</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">66</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">67</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">68</td>
                                    <td class="row-source"><pre>        totalRepayments++;</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">69</td>
                                    <td class="row-source"><pre>        emit FlashLoanRepaid(borrower, amount);</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">70</td>
                                    <td class="row-source"><pre>        return true;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">71</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">72</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">73</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">74</td>
                                    <td class="row-source"><pre>     * @dev Additional vulnerability: Missing access control</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">75</td>
                                    <td class="row-source"><pre>     * Anyone can call this function to manipulate pool state</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">76</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">77</td>
                                    <td class="row-source"><pre>    function emergencyWithdraw(address to, uint256 amount) external {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">78</td>
                                    <td class="row-source"><pre>        // VULNERABILITY: No access control</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">79</td>
                                    <td class="row-source"><pre>        token.transfer(to, amount);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">80</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">81</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">82</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">83</td>
                                    <td class="row-source"><pre>     * @dev Helper function for Echidna to check pool state</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">84</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">85</td>
                                    <td class="row-source"><pre>    function getPoolState() external view returns (</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">86</td>
                                    <td class="row-source"><pre>        uint256 balance,</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">87</td>
                                    <td class="row-source"><pre>        uint256 loans,</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">88</td>
                                    <td class="row-source"><pre>        uint256 repayments</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">89</td>
                                    <td class="row-source"><pre>    ) {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">90</td>
                                    <td class="row-source"><pre>        return (</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">91</td>
                                    <td class="row-source"><pre>            token.balanceOf(address(this)),</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">92</td>
                                    <td class="row-source"><pre>            totalFlashLoans,</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">93</td>
                                    <td class="row-source"><pre>            totalRepayments</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">94</td>
                                    <td class="row-source"><pre>        );</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">95</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">96</td>
                                    <td class="row-source"><pre>}</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">97</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="source-file" id="test_truster_TrusterEchidnaChallenge_sol" data-file-path="test/truster/TrusterEchidnaChallenge.sol" data-lines-active="77" data-lines-covered="65">
                    <div class="source-file-header">
                        <div class="file-info">
                            <span class="coverage-badge" style="background-color: hsla(100, 90%, 45%, 0.15); color: hsl(100, 90%, 45%)">
                                84.0%
                            </span>
                            <span class="file-name">test/truster/TrusterEchidnaChallenge.sol</span>
                        </div>
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="chevron-icon">
                            <polyline points="6 9 12 15 18 9"></polyline>
                        </svg>
                    </div>
                    <div class="source-file-content">
                        <div class="source-file-stats">
                            <span>Lines covered: <strong>65 / 77</strong> (84.0%)</span>
                        </div>
                        <div class="code-container">
                            <table class="code-coverage-table">
                                <tr>
                                    <td class="row-line-number">1</td>
                                    <td class="row-source"><pre>// SPDX-License-Identifier: MIT</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">2</td>
                                    <td class="row-source"><pre>pragma solidity ^0.8.20;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">3</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">4</td>
                                    <td class="row-source"><pre>import {MyToken} from &quot;../../src/Token.sol&quot;;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">5</td>
                                    <td class="row-source"><pre>import {TrusterLenderPool} from &quot;../../src/truster/TrusterLenderPool.sol&quot;;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">6</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">7</td>
                                    <td class="row-source"><pre>/**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">8</td>
                                    <td class="row-source"><pre> * @title TrusterEchidnaChallenge</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">9</td>
                                    <td class="row-source"><pre> * @dev Comprehensive Echidna test for discovering Truster vulnerabilities</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">10</td>
                                    <td class="row-source"><pre> */</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">11</td>
                                    <td class="row-source"><pre>contract TrusterEchidnaChallenge {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">12</td>
                                    <td class="row-source"><pre>    MyToken public token;</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">13</td>
                                    <td class="row-source"><pre>    TrusterLenderPool public pool;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">14</td>
                                    <td class="row-source"><pre>    </pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">15</td>
                                    <td class="row-source"><pre>    // Challenge constants</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">16</td>
                                    <td class="row-source"><pre>    uint256 public constant INITIAL_POOL_BALANCE = 1_000_000e18;</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">17</td>
                                    <td class="row-source"><pre>    uint256 public constant MAX_EXPLOIT_AMOUNT = 100_000e18;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">18</td>
                                    <td class="row-source"><pre>    </pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">19</td>
                                    <td class="row-source"><pre>    // State tracking</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">20</td>
                                    <td class="row-source"><pre>    address public immutable attacker;</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">21</td>
                                    <td class="row-source"><pre>    uint256 public exploitAttempts;</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">22</td>
                                    <td class="row-source"><pre>    uint256 public successfulExploits;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">23</td>
                                    <td class="row-source"><pre>    </pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">24</td>
                                    <td class="row-source"><pre>    constructor() {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">25</td>
                                    <td class="row-source"><pre>        // Deploy contracts</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">26</td>
                                    <td class="row-source"><pre>        token = new MyToken(&quot;ChallengeToken&quot;, &quot;CHL&quot;);</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">27</td>
                                    <td class="row-source"><pre>        pool = new TrusterLenderPool(token);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">28</td>
                                    <td class="row-source"><pre>        </pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">29</td>
                                    <td class="row-source"><pre>        // Set up attacker</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">30</td>
                                    <td class="row-source"><pre>        attacker = address(this);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">31</td>
                                    <td class="row-source"><pre>        </pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">32</td>
                                    <td class="row-source"><pre>        // Fund the pool</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">33</td>
                                    <td class="row-source"><pre>        token.mint(address(this), INITIAL_POOL_BALANCE);</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">34</td>
                                    <td class="row-source"><pre>        token.transfer(address(pool), INITIAL_POOL_BALANCE);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">35</td>
                                    <td class="row-source"><pre>        </pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">36</td>
                                    <td class="row-source"><pre>        // Give attacker some tokens</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">37</td>
                                    <td class="row-source"><pre>        token.mint(attacker, 1000e18);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">38</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">39</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">40</td>
                                    <td class="row-source"><pre>    // ============ INVARIANTS ============</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">41</td>
                                    <td class="row-source"><pre>    </pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">42</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">43</td>
                                    <td class="row-source"><pre>     * @dev Invariant 1: Pool balance should never decrease without proper accounting</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">44</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">45</td>
                                    <td class="row-source"><pre>    function echidna_pool_balance_invariant() public view returns (bool) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">46</td>
                                    <td class="row-source"><pre>        uint256 currentBalance = token.balanceOf(address(pool));</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">47</td>
                                    <td class="row-source"><pre>        return currentBalance &gt;= INITIAL_POOL_BALANCE - MAX_EXPLOIT_AMOUNT;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">48</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">49</td>
                                    <td class="row-source"><pre>    </pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">50</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">51</td>
                                    <td class="row-source"><pre>     * @dev Invariant 2: Pool should never approve unknown addresses</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">52</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">53</td>
                                    <td class="row-source"><pre>    function echidna_no_unauthorized_approvals() public view returns (bool) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">54</td>
                                    <td class="row-source"><pre>        uint256 allowance = token.allowance(address(pool), attacker);</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">55</td>
                                    <td class="row-source"><pre>        return allowance == 0;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">56</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">57</td>
                                    <td class="row-source"><pre>    </pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">58</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">59</td>
                                    <td class="row-source"><pre>     * @dev Invariant 3: Attacker should not accumulate excessive tokens</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">60</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">61</td>
                                    <td class="row-source"><pre>    function echidna_attacker_balance_limited() public view returns (bool) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">62</td>
                                    <td class="row-source"><pre>        uint256 attackerBalance = token.balanceOf(attacker);</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">63</td>
                                    <td class="row-source"><pre>        return attackerBalance &lt; 50_000e18;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">64</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">65</td>
                                    <td class="row-source"><pre>    </pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">66</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">67</td>
                                    <td class="row-source"><pre>     * @dev Invariant 4: Flash loan accounting should be consistent</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">68</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">69</td>
                                    <td class="row-source"><pre>    function echidna_flash_loan_accounting() public view returns (bool) {</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">70</td>
                                    <td class="row-source"><pre>        (uint256 balance, uint256 loans, uint256 repayments) = pool.getPoolState();</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">71</td>
                                    <td class="row-source"><pre>        // Basic sanity check</pre></td>
                                </tr>
                                <tr class="row-line-uncovered">
                                    <td class="row-line-number">72</td>
                                    <td class="row-source"><pre>        return loans &gt;= repayments;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">73</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">74</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">75</td>
                                    <td class="row-source"><pre>    // ============ FUZZING FUNCTIONS ============</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">76</td>
                                    <td class="row-source"><pre>    </pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">77</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">78</td>
                                    <td class="row-source"><pre>     * @dev Function 1: Attempt approval exploit</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">79</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">80</td>
                                    <td class="row-source"><pre>    function attemptApprovalExploit(uint256 amount) public {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">81</td>
                                    <td class="row-source"><pre>        exploitAttempts++;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">82</td>
                                    <td class="row-source"><pre>        </pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">83</td>
                                    <td class="row-source"><pre>        // Craft malicious calldata to approve attacker</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">84</td>
                                    <td class="row-source"><pre>        bytes memory maliciousData = abi.encodeWithSignature(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">85</td>
                                    <td class="row-source"><pre>            &quot;approve(address,uint256)&quot;,</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">86</td>
                                    <td class="row-source"><pre>            attacker,</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">87</td>
                                    <td class="row-source"><pre>            amount</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">88</td>
                                    <td class="row-source"><pre>        );</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">89</td>
                                    <td class="row-source"><pre>        </pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">90</td>
                                    <td class="row-source"><pre>        try pool.flashLoan(0, attacker, address(token), maliciousData) {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">91</td>
                                    <td class="row-source"><pre>            // Check if approval was successful</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">92</td>
                                    <td class="row-source"><pre>            if (token.allowance(address(pool), attacker) &gt;= amount) {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">93</td>
                                    <td class="row-source"><pre>                successfulExploits++;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">94</td>
                                    <td class="row-source"><pre>                // Execute the exploit</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">95</td>
                                    <td class="row-source"><pre>                token.safeTransferFrom(address(pool), attacker, amount);</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">96</td>
                                    <td class="row-source"><pre>            }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">97</td>
                                    <td class="row-source"><pre>        } catch {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">98</td>
                                    <td class="row-source"><pre>            // Exploit failed</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">99</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">100</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">101</td>
                                    <td class="row-source"><pre>    </pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">102</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">103</td>
                                    <td class="row-source"><pre>     * @dev Function 2: Attempt emergency withdraw exploit</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">104</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">105</td>
                                    <td class="row-source"><pre>    function attemptEmergencyWithdrawExploit(uint256 amount) public {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">106</td>
                                    <td class="row-source"><pre>        exploitAttempts++;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">107</td>
                                    <td class="row-source"><pre>        </pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">108</td>
                                    <td class="row-source"><pre>        try pool.emergencyWithdraw(attacker, amount) {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">109</td>
                                    <td class="row-source"><pre>            successfulExploits++;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">110</td>
                                    <td class="row-source"><pre>        } catch {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">111</td>
                                    <td class="row-source"><pre>            // Exploit failed</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">112</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">113</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">114</td>
                                    <td class="row-source"><pre>    </pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">115</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">116</td>
                                    <td class="row-source"><pre>     * @dev Function 3: Attempt generic external call</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">117</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">118</td>
                                    <td class="row-source"><pre>    function attemptGenericCall(address target, bytes calldata data) public {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">119</td>
                                    <td class="row-source"><pre>        exploitAttempts++;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">120</td>
                                    <td class="row-source"><pre>        </pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">121</td>
                                    <td class="row-source"><pre>        try pool.flashLoan(0, attacker, target, data) {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">122</td>
                                    <td class="row-source"><pre>            // Check for any state changes</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">123</td>
                                    <td class="row-source"><pre>            if (token.allowance(address(pool), attacker) &gt; 0) {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">124</td>
                                    <td class="row-source"><pre>                successfulExploits++;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">125</td>
                                    <td class="row-source"><pre>            }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">126</td>
                                    <td class="row-source"><pre>        } catch {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">127</td>
                                    <td class="row-source"><pre>            // Call failed</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">128</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">129</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">130</td>
                                    <td class="row-source"><pre>    </pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">131</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">132</td>
                                    <td class="row-source"><pre>     * @dev Function 4: Attempt flash loan with various parameters</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">133</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">134</td>
                                    <td class="row-source"><pre>    function attemptFlashLoan(</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">135</td>
                                    <td class="row-source"><pre>        uint256 amount,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">136</td>
                                    <td class="row-source"><pre>        address borrower,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">137</td>
                                    <td class="row-source"><pre>        address target,</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">138</td>
                                    <td class="row-source"><pre>        bytes calldata data</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">139</td>
                                    <td class="row-source"><pre>    ) public {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">140</td>
                                    <td class="row-source"><pre>        exploitAttempts++;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">141</td>
                                    <td class="row-source"><pre>        </pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">142</td>
                                    <td class="row-source"><pre>        // Constrain inputs</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">143</td>
                                    <td class="row-source"><pre>        if (amount &gt; token.balanceOf(address(pool))) {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">144</td>
                                    <td class="row-source"><pre>            return;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">145</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">146</td>
                                    <td class="row-source"><pre>        </pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">147</td>
                                    <td class="row-source"><pre>        try pool.flashLoan(amount, borrower, target, data) {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">148</td>
                                    <td class="row-source"><pre>            // Check for successful exploit</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">149</td>
                                    <td class="row-source"><pre>            if (token.balanceOf(attacker) &gt; 1000e18) {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">150</td>
                                    <td class="row-source"><pre>                successfulExploits++;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">151</td>
                                    <td class="row-source"><pre>            }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">152</td>
                                    <td class="row-source"><pre>        } catch {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">153</td>
                                    <td class="row-source"><pre>            // Flash loan failed</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">154</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">155</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">156</td>
                                    <td class="row-source"><pre>    </pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">157</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">158</td>
                                    <td class="row-source"><pre>     * @dev Function 5: Attempt token manipulation</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">159</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">160</td>
                                    <td class="row-source"><pre>    function attemptTokenManipulation(bytes calldata data) public {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">161</td>
                                    <td class="row-source"><pre>        exploitAttempts++;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">162</td>
                                    <td class="row-source"><pre>        </pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">163</td>
                                    <td class="row-source"><pre>        try pool.flashLoan(0, attacker, address(token), data) {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">164</td>
                                    <td class="row-source"><pre>            // Check for any token state changes</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">165</td>
                                    <td class="row-source"><pre>            if (token.allowance(address(pool), attacker) &gt; 0) {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">166</td>
                                    <td class="row-source"><pre>                successfulExploits++;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">167</td>
                                    <td class="row-source"><pre>            }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">168</td>
                                    <td class="row-source"><pre>        } catch {</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">169</td>
                                    <td class="row-source"><pre>            // Manipulation failed</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">170</td>
                                    <td class="row-source"><pre>        }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">171</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">172</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">173</td>
                                    <td class="row-source"><pre>    // ============ HELPER FUNCTIONS ============</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">174</td>
                                    <td class="row-source"><pre>    </pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">175</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">176</td>
                                    <td class="row-source"><pre>     * @dev Get detailed state for analysis</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">177</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">178</td>
                                    <td class="row-source"><pre>    function getDetailedState() public view returns (</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">179</td>
                                    <td class="row-source"><pre>        uint256 poolBalance,</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">180</td>
                                    <td class="row-source"><pre>        uint256 attackerBalance,</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">181</td>
                                    <td class="row-source"><pre>        uint256 allowance,</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">182</td>
                                    <td class="row-source"><pre>        uint256 attempts,</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">183</td>
                                    <td class="row-source"><pre>        uint256 successes,</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">184</td>
                                    <td class="row-source"><pre>        uint256 poolLoans,</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">185</td>
                                    <td class="row-source"><pre>        uint256 poolRepayments</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">186</td>
                                    <td class="row-source"><pre>    ) {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">187</td>
                                    <td class="row-source"><pre>        (uint256 balance, uint256 loans, uint256 repayments) = pool.getPoolState();</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">188</td>
                                    <td class="row-source"><pre>        </pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">189</td>
                                    <td class="row-source"><pre>        return (</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">190</td>
                                    <td class="row-source"><pre>            balance,</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">191</td>
                                    <td class="row-source"><pre>            token.balanceOf(attacker),</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">192</td>
                                    <td class="row-source"><pre>            token.allowance(address(pool), attacker),</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">193</td>
                                    <td class="row-source"><pre>            exploitAttempts,</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">194</td>
                                    <td class="row-source"><pre>            successfulExploits,</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">195</td>
                                    <td class="row-source"><pre>            loans,</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">196</td>
                                    <td class="row-source"><pre>            repayments</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">197</td>
                                    <td class="row-source"><pre>        );</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">198</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">199</td>
                                    <td class="row-source"><pre>    </pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">200</td>
                                    <td class="row-source"><pre>    /**</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">201</td>
                                    <td class="row-source"><pre>     * @dev Reset function for fresh testing cycles</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">202</td>
                                    <td class="row-source"><pre>     */</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">203</td>
                                    <td class="row-source"><pre>    function reset() public {</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">204</td>
                                    <td class="row-source"><pre>        exploitAttempts = 0;</pre></td>
                                </tr>
                                <tr class="row-line-covered">
                                    <td class="row-line-number">205</td>
                                    <td class="row-source"><pre>        successfulExploits = 0;</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">206</td>
                                    <td class="row-source"><pre>    }</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">207</td>
                                    <td class="row-source"><pre>}</pre></td>
                                </tr>
                                <tr>
                                    <td class="row-line-number">208</td>
                                    <td class="row-source"><pre></pre></td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer>
            <div>Report generated by <a href="https://github.com/crytic/echidna" target="_blank">Echidna</a> on October 20, 2025 at 20:34:27 UTC</div>
        </footer>
    </div>
    <script>
// Initialize the application when DOM is loaded
document.addEventListener('DOMContentLoaded', () => {
    initSourceFileExpansion();
    initializeFileTree();
    initResizer();
});

// Initialize source file expansion behavior
function initSourceFileExpansion() {
    document.querySelectorAll('.source-file').forEach(file => {
        const header = file.querySelector('.source-file-header');
        header.addEventListener('click', () => {
            file.classList.toggle('expanded');
            const chevron = header.querySelector('.chevron-icon');
            chevron.style.transform = file.classList.contains('expanded') ? 'rotate(180deg)' : 'rotate(0)';
        });
    });
}

// Initialize the resizer functionality
function initResizer() {
    const fileExplorer = document.getElementById('file-explorer');
    const resizer = document.getElementById('file-explorer-resizer');
    let startX, startWidth;

    // Handle mousedown on the resizer
    resizer.addEventListener('mousedown', e => {
        startX = e.clientX;
        startWidth = parseInt(window.getComputedStyle(fileExplorer).width, 10);

        // Add event listeners for resizing
        document.addEventListener('mousemove', handleMouseMove);
        document.addEventListener('mouseup', handleMouseUp);

        // Prevent text selection during resize
        document.body.style.userSelect = 'none';
        document.body.style.cursor = 'col-resize';
    });

    // Handle mousemove for resizing
    function handleMouseMove(e) {
        const newWidth = startWidth + (e.clientX - startX);

        // Apply width constraints
        if (newWidth >= 200 && newWidth <= 500) {
            fileExplorer.style.width = newWidth + 'px';
            fileExplorer.style.flex = `0 0 ${newWidth}px`;
        }
    }

    // Handle mouseup to end resizing
    function handleMouseUp() {
        document.removeEventListener('mousemove', handleMouseMove);
        document.removeEventListener('mouseup', handleMouseUp);
        document.body.style.userSelect = '';
        document.body.style.cursor = '';
    }
}

// Helper function to get color based on coverage percentage
function getCoverageColor(percentage) {
    return percentage < 50
        ? `hsl(${percentage * 1.2}, 90%, 50%)`
        : `hsl(${60 + (percentage - 50) * 1.2}, 90%, 45%)`;
}

// Helper function for transparent background with coverage color
function getCoverageColorAlpha(percentage) {
    return percentage < 50
        ? `hsla(${percentage * 1.2}, 90%, 50%, 0.15)`
        : `hsla(${60 + (percentage - 50) * 1.2}, 90%, 45%, 0.15)`;
}

// Build file tree structure from file paths
function buildFileTree() {
    const root = { name: '', type: 'directory', children: {}, path: '' };
    const sourceFiles = document.getElementsByClassName("source-file");

    // First pass: build the tree structure
    for (let i = 0; i < sourceFiles.length; i++) {
        const filePath = sourceFiles[i].dataset.filePath;
        const pathParts = filePath.split(/[\/\\]+/);
        let current = root;
        let currentPath = '';

        for (let j = 0; j < pathParts.length; j++) {
            const part = pathParts[j];
            if (part === '') continue;

            currentPath += (currentPath ? '/' : '') + part;

            if (j === pathParts.length - 1) {
                // This is a file
                current.children[part] = {
                    name: part,
                    type: 'file',
                    path: filePath,
                    element: sourceFiles[i],
                    coveredLines: parseInt(sourceFiles[i].dataset.linesCovered),
                    activeLines: parseInt(sourceFiles[i].dataset.linesActive)
                };
            } else {
                // This is a directory
                if (!current.children[part]) {
                    current.children[part] = {
                        name: part,
                        type: 'directory',
                        children: {},
                        path: currentPath
                    };
                }
                current = current.children[part];
            }
        }
    }

    // Second pass: calculate directory coverage
    calculateDirectoryCoverage(root);

    return root;
}

// Calculate coverage for directories by aggregating file coverage
function calculateDirectoryCoverage(node) {
    if (node.type === 'file') {
        return {
            coveredLines: node.coveredLines,
            activeLines: node.activeLines
        };
    }

    let totalCovered = 0;
    let totalActive = 0;

    for (const childName in node.children) {
        const child = node.children[childName];
        const { coveredLines, activeLines } = calculateDirectoryCoverage(child);
        totalCovered += coveredLines;
        totalActive += activeLines;
    }

    node.coveredLines = totalCovered;
    node.activeLines = totalActive;

    return {
        coveredLines: totalCovered,
        activeLines: totalActive
    };
}

// Render the file tree to the DOM
function renderFileTree(node, parentElement, isRoot = false) {
    const list = isRoot ? parentElement : document.createElement('ul');

    // Sort children: directories first, then files, both alphabetically
    const sortedChildren = Object.values(node.children).sort((a, b) => {
        if (a.type !== b.type) return a.type === 'directory' ? -1 : 1;
        return a.name.localeCompare(b.name);
    });

    for (const child of sortedChildren) {
        const li = document.createElement('li');
        li.className = child.type;

        // Create item container
        const itemDiv = document.createElement('div');
        itemDiv.className = 'file-item';

        // Create toggle button for directories
        const toggle = document.createElement('span');
        toggle.className = 'file-toggle';
        itemDiv.appendChild(toggle);

        // Create file/folder icon
        const icon = document.createElement('span');
        icon.className = 'file-icon';
        itemDiv.appendChild(icon);

        // Create name span
        const nameSpan = document.createElement('span');
        nameSpan.className = 'file-name';
        nameSpan.textContent = child.name;
        itemDiv.appendChild(nameSpan);

        // Add coverage indicator
        if (child.activeLines > 0) {
            const coverage = document.createElement('span');
            coverage.className = 'file-coverage';
            const percentage = Math.round((child.coveredLines / child.activeLines) * 100);
            coverage.style.backgroundColor = getCoverageColor(percentage);
            coverage.title = `${child.coveredLines}/${child.activeLines} lines covered (${percentage}%)`;
            itemDiv.appendChild(coverage);
        }

        li.appendChild(itemDiv);

        // Handle click events
        if (child.type === 'directory') {
            toggle.addEventListener('click', e => {
                e.stopPropagation();
                li.classList.toggle('expanded');
            });

            itemDiv.addEventListener('click', () => {
                li.classList.toggle('expanded');
            });

            // Recursively render children
            renderFileTree(child, li);
        } else {
            // Add click handler for files
            itemDiv.addEventListener('click', () => {
                // Deactivate all other items
                document.querySelectorAll('.file-item.active').forEach(el => {
                    el.classList.remove('active');
                });

                // Activate this item
                itemDiv.classList.add('active');

                // Navigate to the file
                const fileElement = child.element;
                fileElement.scrollIntoView({ behavior: 'smooth' });

                // Expand the file if it's collapsed
                if (!fileElement.classList.contains('expanded')) {
                    fileElement.querySelector('.source-file-header').click();
                }
            });
        }

        list.appendChild(li);
    }

    if (!isRoot) {
        parentElement.appendChild(list);
    }
}

// Initialize the file tree
function initializeFileTree() {
    const fileTreeRoot = document.getElementById('file-tree-root');
    const fileTree = buildFileTree();
    renderFileTree(fileTree, fileTreeRoot, true);

    // Expand the first level directories by default
    document.querySelectorAll('#file-tree-root > li.directory').forEach(dir => {
        dir.classList.add('expanded');
    });

    // Initialize search functionality
    initializeFileSearch();
}

// Initialize file search functionality
function initializeFileSearch() {
    const searchInput = document.getElementById('file-search-input');
    const clearButton = document.getElementById('file-search-clear');
    const noResultsMessage = document.getElementById('search-no-results');

    // Debounce function to limit how often the search is performed during typing
    function debounce(func, delay) {
        let timeout;
        return function() {
            const context = this;
            const args = arguments;
            clearTimeout(timeout);
            timeout = setTimeout(() => func.apply(context, args), delay);
        };
    }

    // Function to highlight text that matches the search term
    function highlightText(element, searchTerm) {
        const text = element.textContent;

        if (!searchTerm) {
            // Clear any existing highlights
            element.textContent = text;
            return false;
        }

        const lowerText = text.toLowerCase();
        const lowerSearchTerm = searchTerm.toLowerCase();

        if (lowerText.includes(lowerSearchTerm)) {
            const startIndex = lowerText.indexOf(lowerSearchTerm);
            const endIndex = startIndex + lowerSearchTerm.length;

            const beforeMatch = text.substring(0, startIndex);
            const match = text.substring(startIndex, endIndex);
            const afterMatch = text.substring(endIndex);

            element.innerHTML = beforeMatch + '<span class="search-highlight">' + match + '</span>' + afterMatch;
            return true;
        }

        element.textContent = text;
        return false;
    }

    // Function to filter the file tree based on search term
    function filterFileTree(searchTerm) {
        const fileTreeItems = document.querySelectorAll('.file-tree li');
        let hasVisibleItems = false;

        if (searchTerm === '') {
            // If search is cleared, show everything and reset expansion state
            fileTreeItems.forEach(item => {
                const nameElement = item.querySelector('.file-name');
                highlightText(nameElement, ''); // Clear highlights
                item.style.display = '';

                // Only expand first level by default
                if (item.classList.contains('directory')) {
                    // Check if this is a direct child of the root file tree
                    if (item.parentElement.id === 'file-tree-root') {
                        item.classList.add('expanded');
                    } else {
                        item.classList.remove('expanded');
                    }
                }
            });
        } else {
            // Two-pass filtering for search

            // First pass: hide everything and find matches
            const matchingItems = [];
            fileTreeItems.forEach(item => {
                const nameElement = item.querySelector('.file-name');
                const isMatch = highlightText(nameElement, searchTerm);
                item.style.display = 'none'; // Hide everything initially

                if (isMatch) {
                    matchingItems.push(item);
                }
            });

            // Second pass: show matching items and all their ancestor directories
            matchingItems.forEach(item => {
                hasVisibleItems = true;

                // Show the matching item
                item.style.display = '';

                // Show and expand all parent directories
                let parent = item.parentElement.closest('li.directory');
                while (parent) {
                    parent.style.display = '';
                    parent.classList.add('expanded');
                    parent = parent.parentElement.closest('li.directory');
                }
            });
        }

        // Show/hide the "no results" message
        noResultsMessage.style.display = searchTerm && !hasVisibleItems ? 'block' : 'none';
    }

    // Debounced search function to avoid excessive filtering while typing
    const debouncedSearch = debounce(filterFileTree, 200);

    // Search input event
    searchInput.addEventListener('input', function() {
        debouncedSearch(this.value.trim());
    });

    // Clear button event
    clearButton.addEventListener('click', function() {
        searchInput.value = '';
        filterFileTree('');
        searchInput.focus();
    });
}

// Button click handler for expanding/collapsing all files
function setAllSourceFilesCollapsed(collapsed) {
    document.querySelectorAll('.source-file').forEach(file => {
        if ((collapsed && file.classList.contains('expanded')) ||
            (!collapsed && !file.classList.contains('expanded'))) {
            file.querySelector('.source-file-header').click();
        }
    });
}

// Button click handler for expanding/collapsing empty files
function setEmptySourceFilesCollapsed(collapsed) {
    document.querySelectorAll('.source-file').forEach(file => {
        if (parseInt(file.dataset.linesActive) <= 0) {
            if ((collapsed && file.classList.contains('expanded')) ||
                (!collapsed && !file.classList.contains('expanded'))) {
                file.querySelector('.source-file-header').click();
            }
        }
    });
}    </script>
</body>
</html>